{"version":3,"file":"my-search-bar.js","sources":["components/my-search-bar/my-search-bar.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDoveGlhb2NoZW5neHUvcHJvamVjdC1zcGFjZS91bmkt5p2P5p6X5pil5pqWL2NvbXBvbmVudHMvbXktc2VhcmNoLWJhci9teS1zZWFyY2gtYmFyLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"search-container\">\n\t\t<view class=\"search-bar\">\n\t\t\t<image src=\"/static/搜索栏-01.png\" mode=\"aspectFill\"></image>\n\t\t\t<view class=\"placeholder-container\">\r\n\t\t\t\t<!-- 动画时长300ms，动画滑动方向，自定义样式 -->\n\t\t\t\t<uni-transition \n\t\t\t\t\t:show=\"showPlaceholder\"\n\t\t\t\t\t:duration=\"300\"\n\t\t\t\t\t:mode-class=\"animationDirection\"\n\t\t\t\t\t:styles=\"transitionStyles\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tref=\"searchInput\"\n\t\t\t\t\t\t\t@focus=\"handleFocus\" \n\t\t\t\t\t\t\t@blur=\"handleBlur\" \n\t\t\t\t\t\t\t@input=\"handleInput\"\n\t\t\t\t\t\t\t:disabled=\"isAnimating\"\n\t\t\t\t\t\t\t:placeholder=\"currentPlaceholder\"\n\t\t\t\t\t\t\tv-model=\"inputValue\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t</uni-transition>\n\t\t\t</view>\n\t\t\t<button @click=\"performSearch\">搜索</button>\n\t\t</view>\n\t\t<view class=\"suggestion-list\" v-if=\"matchedItems.length>0\">\n\t\t\t<scroll-view scroll-y=\"true\" class=\"list-container\">\n\t\t\t\t<view\n\t\t\t\t\tv-for=\"(item,index) in matchedItems\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\tclass=\"suggestion-item\"\n\t\t\t\t\t@tap=\"selectItem(item)\"\n\t\t\t\t>\n\t\t\t\t\t{{item}}\n\t\t\t\t</view>\n\t\t\t</scroll-view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\r\n\timport { nameData } from '@/data/herbData';\n\t\n\texport default{\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\tplaceholderIndex:0,\t\t// 当前提示词索引\n\t\t\t\tplaceholders:nameData,  // 绑定数据集\n\t\t\t\ttimer:null,\t\t\t\t// 轮播定时器\n\t\t\t\tshowPlaceholder: true,  // 控制动画元素显示\n\t\t\t\tanimationDirection:'slide-top',\t// 动画方向（初始向上滑出）\n\t\t\t\tisAnimating: false,     // 动画状态锁（防止动画冲突）\n\t\t\t\ttransitionStyles: {\t\t// 动画容器样式\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\talignItems: 'center',\n\t\t\t\t\theight: '100%',\n\t\t\t\t\twidth: '100%',\n\t\t\t\t},\n\t\t\t\tinputValue:'',\n\t\t\t\tmatchedItems:[],\t// 匹配的药材列表\n\t\t\t\tisFocused:false,\t// 输入框聚焦状态\n\t\t\t\tisSelecting:false,\t//选择状态锁（防止失焦冲突）\n\t\t\t\tinputTimer:null\t\t// 输入防抖定时器\n\t\t\t};\n\t\t},\n\t\tcomputed: {\n\t\t\t// 动态计算当前提示词\n\t\t\tcurrentPlaceholder() {\n\t\t\t\treturn nameData[this.placeholderIndex];\n\t\t\t}\n\t\t},\n\t\tmethods:{\r\n\t\t\t// 输入框聚焦事件处理\n\t\t\thandleFocus(){\n\t\t\t\tthis.pauseRotation();\t// 暂停占位符轮播\n\t\t\t\tthis.isFocused = true;\t// 标记聚焦状态\r\n\t\t\t\t// 已有输入内容时显示建议列表\n\t\t\t\tif(this.inputValue){\n\t\t\t\t\tthis.filterSuggestions();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\r\n\t\t\t// 输入框失焦事件处理\n\t\t\thandleBlur(){\r\n\t\t\t\t// 延迟300ms处理，避免与选择状态锁冲突\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tif (this.$refs.searchInput && !this.isSelecting) {\r\n\t\t\t\t\t    this.$refs.searchInput.blur();\r\n\t\t\t\t\t}\n\t\t\t\t\tthis.resumeRotation();\t// 恢复轮播\n\t\t\t\t},300)\n\t\t\t},\n\t\t\t\r\n\t\t\t// 输入事件处理\n\t\t\thandleInput(event){\n\t\t\t\tthis.inputValue = event.detail.value; // 更新输入值\n\t\t\t\t// 添加防抖处理（300ms延迟）\n\t\t\t\tclearTimeout(this.inputTimer);\n\t\t\t\tthis.inputTimer = setTimeout(() => {\n\t\t\t\t\tthis.filterSuggestions();\n\t\t\t\t}, 300);\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 过滤建议项\n\t\t\tfilterSuggestions(){\n\t\t\t\tif(!this.inputValue){\n\t\t\t\t\tthis.matchedItems = [];\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tconst keyword = this.inputValue.toLowerCase();\r\n\t\t\t\t// 过滤包含关键词的药材名称\n\t\t\t\tthis.matchedItems = nameData.filter(item => \n\t\t\t\t    item.toLowerCase().includes(keyword) // 包含即匹配\n\t\t\t\t);\n\t\t\t},\n\t\t\t\r\n\t\t\t// 选择建议项\n\t\t\tselectItem(item){\r\n\t\t\t\tthis.isSelecting = true;\t// 标记选择状态\n\t\t\t\tthis.inputValue = item;\n\t\t\t\tthis.matchedItems = [];\r\n\t\t\t\t// 强制重新渲染输入框\r\n\t\t\t\tthis.inputKey = Date.now();\t// 每次更新唯一标识\n\t\t\t\tthis.performSearch();\t// 执行搜索\n\t\t\t},\n\t\t\t\r\n\t\t\t// 执行搜索\n\t\t\tperformSearch(){\n\t\t\t\tif(this.inputValue){\n\t\t\t\t\tconsole.log(\"执行搜索：\",this.inputValue);\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: `/pages/content/content?keyword=${encodeURIComponent(this.inputValue)}`,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.inputValue='';\n\t\t\t\t}\n\t\t\t},\n\t\t\t\r\n\t\t\t// 启动占位符轮播\n\t\t\tstartRotation() {\n\t\t\t    this.timer = setInterval(() => {\n\t\t\t\tif (this.isAnimating) return; \t// 动画中跳过\n\t\t\t\tthis.isAnimating = true;\t\t// 锁定状态\n\t\t\t\t\n\t\t\t\t// 触发向上滑出动画\n\t\t\t\tthis.animationDirection = 'slide-top';\n\t\t\t\tthis.showPlaceholder = false;\t// 隐藏元素（触发离开动画）\n\t\t\t\t\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t// 循环更新索引\n\t\t\t\t\tthis.placeholderIndex = (this.placeholderIndex + 1) % this.placeholders.length;\n\t\t\t\t\tthis.showPlaceholder = true;\t// 显示新词（触发进入动画）\n\t\t\t\t  \n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t// 动画结束后解锁状态\n\t\t\t\t\t\tthis.isAnimating = false;\n\t\t\t\t  }, 300);\t// 等待进入动画完成\n\t\t\t\t}, 300);\t// 等待离开动画完成\n\t\t\t  }, 3000);\t// 每3秒轮播一次\n\t\t\t},\n\t\t\tpauseRotation(){\n\t\t\t\tclearInterval(this.timer)//\t清除定时器（暂停轮播）\n\t\t\t},\n\t\t\tresumeRotation() {\n\t\t\t\tthis.pauseRotation();\n\t\t\t\tthis.startRotation(); // 重启轮播\n\t\t\t}\n\t\t},\n\t\tmounted(){\n\t\t\tthis.startRotation();\t// 组件挂载时启动轮播\n\t\t},\n\t\tbeforeUnmount(){\n\t\t\tthis.pauseRotation();\t// 组件销毁前清理定时器（防内存泄漏）\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.search-bar{\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 90rpx;\n\t\tbackground: linear-gradient(135deg, #f8f4e5, #e8f5e9);\n\t\tposition: relative;\n\t\tz-index: 60;\r\n\t\tpadding: 0 10rpx 0 10rpx;\n\t}\r\n\t\n\t.search-bar image{\n\t\twidth: 60rpx;\n\t\theight: 40rpx;\n\t\tz-index: 20;\n\t}\r\n\t  \n\t.search-bar input{\n\t\theight: 100%;\n\t\twidth: 100%;\n\t\tfont-size: 32rpx;\n\t\tcolor: #333;\n\t\tbackground: transparent;\n\t\tz-index: 15;\n\t}\r\n\t\n\t.search-bar button {\n\t\tmin-width: 120rpx;\n\t\theight: 60rpx;\n\t\tpadding: 0 20rpx;\n\t\tbackground-color: #4CAF50;\n\t\tcolor: #fff;\n\t\tborder-radius: 30rpx;\n\t\tfont-size: 24rpx;\n\t\tz-index: 25;\n\t}\r\n\t\n\t.search-bar::after {\n\t  content: '';\n\t  position: absolute;\n\t  top: 0;\n\t  right: 0;\n\t  bottom: 0;\n\t  left: 0;\n\t  pointer-events: none;\n\t  z-index: 5;\n\t}\r\n\t\n\t/* 修复对齐问题 */\n\t.uni-transition__content {\n\t  display: flex;\n\t  align-items: center;\n\t}\r\n\t\n\t.placeholder-container {\n\t\tflex: 1;\n\t\theight: 80rpx;\n\t\toverflow: hidden;\n\t\tposition: relative;\n\t\tmargin: 20rpx 20rpx;\n\t}  \r\n\t\n\t.suggestion-list {\n\t    position: absolute; \n\t    top: 85%; /* 从搜索栏底部开始 */\n\t    left: 0;\n\t    right: 0;\n\t    z-index: 140; /* 确保在搜索栏下方 */\n\t    background-color: #f8f4e5;\r\n\t\tborder-radius: 20rpx;\n\t}\r\n\t\n\t.list-container {\n\t    max-height: 400rpx;\n\t}\n\t  \n\t.suggestion-item {\n\t    padding: 20rpx 30rpx;\n\t    font-size: 28rpx;\n\t    border-bottom: 1rpx solid #eee;\n\t}\n\t  \r\n\t/* 建议项点击反馈 */\n\t.suggestion-item:active {\n\t    background-color: #f5f5f5;\t\n\t}\r\n\t  \n\t.search-container {\n\t    position: relative;\r\n\t\tmargin: 0 auto; \r\n\t\twidth: 100%;\n\t}\n</style>","import Component from 'D:/xiaochengxu/project-space/uni-杏林春暖/components/my-search-bar/my-search-bar.vue'\nwx.createComponent(Component)"],"names":["_sfc_main","nameData","event","keyword","item","uni","Component"],"mappings":"+HA2CMA,EAAS,CACb,MAAM,CACL,MAAM,CACL,iBAAiB,EACjB,aAAaC,EAAQ,SACrB,MAAM,KACN,gBAAiB,GACjB,mBAAmB,YACnB,YAAa,GACb,iBAAkB,CACjB,QAAS,OACT,WAAY,SACZ,OAAQ,OACR,MAAO,MACP,EACD,WAAW,GACX,aAAa,CAAE,EACf,UAAU,GACV,YAAY,GACZ,WAAW,KAEZ,EACD,SAAU,CAET,oBAAqB,CACpB,OAAOA,EAAQ,SAAC,KAAK,gBAAgB,CACtC,CACA,EACD,QAAQ,CAEP,aAAa,CACZ,KAAK,cAAa,EAClB,KAAK,UAAY,GAEd,KAAK,YACP,KAAK,kBAAiB,CAEvB,EAGD,YAAY,CAEX,WAAW,IAAI,CACV,KAAK,MAAM,aAAe,CAAC,KAAK,aAChC,KAAK,MAAM,YAAY,OAE3B,KAAK,eAAc,CACnB,EAAC,GAAG,CACL,EAGD,YAAYC,EAAM,CACjB,KAAK,WAAaA,EAAM,OAAO,MAE/B,aAAa,KAAK,UAAU,EAC5B,KAAK,WAAa,WAAW,IAAM,CAClC,KAAK,kBAAiB,CACtB,EAAE,GAAG,CACN,EAGD,mBAAmB,CAClB,GAAG,CAAC,KAAK,WAAW,CACnB,KAAK,aAAe,GACpB,MACD,CACA,MAAMC,EAAU,KAAK,WAAW,YAAW,EAE3C,KAAK,aAAeF,WAAS,OAAOG,GAChCA,EAAK,YAAW,EAAG,SAASD,CAAO,EAEvC,EAGD,WAAWC,EAAK,CACf,KAAK,YAAc,GACnB,KAAK,WAAaA,EAClB,KAAK,aAAe,GAEpB,KAAK,SAAW,KAAK,MACrB,KAAK,cAAa,CAClB,EAGD,eAAe,CACX,KAAK,aACPC,EAAY,MAAA,MAAA,MAAA,oDAAA,QAAQ,KAAK,UAAU,EACnCA,EAAAA,MAAI,WAAW,CACd,IAAK,kCAAkC,mBAAmB,KAAK,UAAU,CAAC,EAC3E,CAAC,EACD,KAAK,WAAW,GAEjB,EAGD,eAAgB,CACZ,KAAK,MAAQ,YAAY,IAAM,CAC9B,KAAK,cACT,KAAK,YAAc,GAGnB,KAAK,mBAAqB,YAC1B,KAAK,gBAAkB,GAEvB,WAAW,IAAM,CAEhB,KAAK,kBAAoB,KAAK,iBAAmB,GAAK,KAAK,aAAa,OACxE,KAAK,gBAAkB,GAEvB,WAAW,IAAM,CAEhB,KAAK,YAAc,EAClB,EAAE,GAAG,CACP,EAAE,GAAG,EACJ,EAAE,GAAI,CACR,EACD,eAAe,CACd,cAAc,KAAK,KAAK,CACxB,EACD,gBAAiB,CAChB,KAAK,cAAa,EAClB,KAAK,cAAa,CACnB,CACA,EACD,SAAS,CACR,KAAK,cAAa,CAClB,EACD,eAAe,CACd,KAAK,cAAa,CACnB,CACD,iyBC5KD,GAAG,gBAAgBC,CAAS"}