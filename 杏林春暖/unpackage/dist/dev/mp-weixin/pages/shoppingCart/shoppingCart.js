"use strict";const e=require("../../common/vendor.js"),l=require("../../common/assets.js"),m={data(){return{cartItems:[],selectedItems:[]}},computed:{totalPrice(){return this.selectedItems.length>0?this.selectedItems.reduce((t,s)=>{const r=this.cartItems[s];return t+r.price*r.quantity},0).toFixed(2):this.cartItems.reduce((t,s)=>t+s.price*s.quantity,0).toFixed(2)},isAllSelected(){return this.cartItems.length===0?!1:this.selectedItems.length===this.cartItems.length}},onShow(){this.loadCartData(),e.index.$on("cart-updated",this.loadCartData)},onHide(){e.index.$off("cart-updated",this.loadCartData)},methods:{loadCartData(){this.cartItems=e.index.getStorageSync("cart")||[]},checkout(){if(this.cartItems.length===0){e.index.showToast({title:"购物车为空",icon:"none"});return}if(this.selectedItems.length>0){const t=this.selectedItems.map(s=>this.cartItems[s]);e.index.navigateTo({url:"/pages/checkout/checkout?items="+encodeURIComponent(JSON.stringify(t))})}else e.index.navigateTo({url:"/pages/checkout/checkout"})},goToContentPage(t){e.index.navigateTo({url:`/pages/content/content?keyword=${t.name}&source=cart`})},goToIndex(){e.index.navigateTo({url:"/pages/index/index"})},toggleSelectItem(t){this.selectedItems.includes(t)?this.selectedItems=this.selectedItems.filter(s=>s!==t):this.selectedItems.push(t)},toggleSelectAll(){this.isAllSelected?this.selectedItems=[]:this.selectedItems=Array.from({length:this.cartItems.length},(t,s)=>s)},changeQuantity(t,s){const r=this.cartItems[t].quantity+s;r>=1?(this.cartItems[t].quantity=r,e.index.setStorageSync("cart",this.cartItems)):e.index.showToast({title:"商品数量不能少于1",icon:"none"})},deleteSelectedItems(){if(this.selectedItems.length===0){e.index.showToast({title:"请选择要删除的商品",icon:"none"});return}const t=[...this.selectedItems].sort((s,r)=>r-s);t.forEach(s=>{this.cartItems.splice(s,1)}),e.index.setStorageSync("cart",this.cartItems),this.selectedItems=[],e.index.showToast({title:`已删除${t.length}件商品`,icon:"success"})}}};if(!Array){const t=e.resolveComponent("my-nav-bar"),s=e.resolveComponent("my-tab-bar");(t+s)()}const h=()=>"../../components/my-nav-bar/my-nav-bar.js",d=()=>"../../components/my-tab-bar/my-tab-bar.js";Math||(h+d)();function g(t,s,r,u,a,n){return e.e({a:e.p({title:"我的购物车"}),b:n.isAllSelected?"/static/选中.png":"/static/未选中.png",c:e.o((...c)=>n.toggleSelectAll&&n.toggleSelectAll(...c)),d:l._imports_0,e:e.o((...c)=>n.deleteSelectedItems&&n.deleteSelectedItems(...c)),f:e.t(a.cartItems.length),g:a.cartItems.length===0},a.cartItems.length===0?{h:l._imports_1,i:e.o((...c)=>n.goToIndex&&n.goToIndex(...c))}:{},{j:e.f(a.cartItems,(c,o,_)=>({a:a.selectedItems.includes(o)?"/static/选中.png":"/static/未选中.png",b:e.o(i=>n.toggleSelectItem(o),c.id),c:c.image,d:e.t(c.name),e:e.t(c.price),f:e.t(c.quantity),g:e.o(i=>n.changeQuantity(o,-1),c.id),h:e.t(c.quantity),i:e.o(i=>n.changeQuantity(o,1),c.id),j:c.id,k:e.o(i=>n.goToContentPage(c),c.id)})),k:e.s(a.cartItems.length===0?"display:none":""),l:l._imports_2,m:l._imports_3,n:a.cartItems.length>0},a.cartItems.length>0?{o:e.t(n.totalPrice),p:e.o((...c)=>n.checkout&&n.checkout(...c))}:{},{q:a.cartItems.length===0?1:""})}const I=e._export_sfc(m,[["render",g],["__scopeId","data-v-aabb6ee4"]]);wx.createPage(I);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/shoppingCart/shoppingCart.js.map
